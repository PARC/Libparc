<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.11"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>PARC Library: /Users/gscott/Documents/workspace/CCNx_Distillery/src/Libparc/parc/algol/parc_Clock.h File Reference</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="masthead.css" rel="stylesheet" type="text/css" />
        <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
<link href="masthead.css" rel="stylesheet" type="text/css"/>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxygen-bootstrap.js"></script>
    </head>
    <body>
        <div class="container masthead">
          <div class="navbar-header">
            <img src="parc_black_solid.png" \>
          </div>
        </div>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">PARC Library </a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Public&#160;Types</span></a></li>
      <li><a href="globals.html"><span>Global&#160;Entities</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_7f9df3ca38d861d94088e98ccd293ed1.html">Libparc</a></li><li class="navelem"><a class="el" href="dir_32724a6363975856e5331f5a8cd1be3e.html">parc</a></li><li class="navelem"><a class="el" href="dir_93537ef564b672990ae767cc40b664ef.html">algol</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">parc_Clock.h File Reference<div class="ingroups"><a class="el" href="group__datastructures.html">Data Structures</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Generic API to a clock.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Generic API to a clock. </p>
<p>Interface over clock providers. We provide two system clocks, a Wallclock that tracks the real time clock and a monotonic clock that will not skew or go backwards. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="parc___clock_8h.html#a7b0ecb2fc31b116ec702c00304a48e91" title="A monotonic clock that will not normally adjust for time changes. ">parcClock_Monotonic()</a> and </dd>
<dd>
<a class="el" href="parc___clock_8h.html#a2db007eb03ec32551e117113bd6c4339" title="A clock provider for the wall clock time. ">parcClock_Wallclock()</a> Also provided is a counting clock. </dd>
<dd>
<a class="el" href="parc___clock_8h.html#ae76be349864034663f1c734bda79ecb1" title="The counter clock begins at 0 and increments for every call to getTime or getTimeval. ">parcClock_Counter()</a></dd></dl>
<p>Below is a complete example of a simple custom clock that implements an atomic counter for the time. Each call to getTime or getTimeval will increment the counter. This clock is available as <a class="el" href="parc___clock_8h.html#ae76be349864034663f1c734bda79ecb1" title="The counter clock begins at 0 and increments for every call to getTime or getTimeval. ">parcClock_Counter()</a>.</p>
<div class="fragment"><div class="line">     <span class="keyword">typedef</span> <span class="keyword">struct </span>counter_clock {</div><div class="line">        uint64_t counter;</div><div class="line">     } _CounterClock;</div><div class="line">  </div><div class="line">     <a class="code" href="parc___object_8h.html#a85fc26f7e1674cf3af9463cfd991a0c5">parcObject_ExtendPARCObject</a>(_CounterClock, NULL, NULL, NULL, NULL, NULL, NULL, NULL);</div><div class="line">     <span class="keyword">static</span> <a class="code" href="parc___object_8h.html#ab362fe6e0188061cd3ada5a20c59444f">parcObject_ImplementAcquire</a>(_counterClock, _CounterClock);</div><div class="line">  </div><div class="line">     <span class="keyword">static</span> PARCClock *</div><div class="line">     _counterClock_AcquireInterface(<span class="keyword">const</span> PARCClock *clock)</div><div class="line">     {</div><div class="line">        _CounterClock *cc = (_CounterClock *) clock-&gt;closure;</div><div class="line">        _counterClock_Acquire(cc);</div><div class="line">        <span class="keywordflow">return</span> (PARCClock *) clock;</div><div class="line">     }</div><div class="line">  </div><div class="line">     <span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line">     _counterClock_ReleaseInterface(PARCClock **clockPtr)</div><div class="line">     {</div><div class="line">        PARCClock *clock = *clockPtr;</div><div class="line">        _CounterClock *cc = (_CounterClock *) clock-&gt;closure;</div><div class="line">  </div><div class="line">        PARCReferenceCount refcount = <a class="code" href="parc___object_8h.html#a9c7af9ce891986965a2c40bdbb55e984">parcObject_Release</a>((<span class="keywordtype">void</span> **) &amp;cc);</div><div class="line">        <span class="keywordflow">if</span> (refcount == 0) {</div><div class="line">           parcMemory_Deallocate((<span class="keywordtype">void</span> **) clockPtr);</div><div class="line">        } <span class="keywordflow">else</span> {</div><div class="line">           *clockPtr = NULL;</div><div class="line">        }</div><div class="line">     }</div><div class="line">  </div><div class="line">     <span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line">     _counterClock_GetTimeval(<span class="keyword">const</span> PARCClock *clock, <span class="keyword">struct</span> timeval *output)</div><div class="line">     {</div><div class="line">        _CounterClock *cc = (_CounterClock *) clock-&gt;closure;</div><div class="line">        uint64_t value = parcAtomicInteger_Uint64Increment(&amp;cc-&gt;counter);</div><div class="line">        <span class="comment">// put 19 bits in the micro-seconds so it is never larger than 1E+6</span></div><div class="line">        output-&gt;tv_sec = value &gt;&gt; 19;</div><div class="line">        output-&gt;tv_usec = value &amp; 0x7FFFF;</div><div class="line">     }</div><div class="line">  </div><div class="line">     <span class="keyword">static</span> uint64_t</div><div class="line">     _counterClock_GetTime(<span class="keyword">const</span> PARCClock *clock)</div><div class="line">     {</div><div class="line">        _CounterClock *cc = (_CounterClock *) clock-&gt;closure;</div><div class="line">        <span class="keywordflow">return</span> parcAtomicInteger_Uint64Increment(&amp;cc-&gt;counter);</div><div class="line">     }</div><div class="line">  </div><div class="line">     PARCClock *</div><div class="line">     <a class="code" href="parc___clock_8h.html#ae76be349864034663f1c734bda79ecb1">parcClock_Counter</a>(<span class="keywordtype">void</span>)</div><div class="line">     {</div><div class="line">        _CounterClock *cc = <a class="code" href="parc___object_8h.html#a7683a1a5373ff9c325af5d4f7d985fcf">parcObject_CreateInstance</a>(_CounterClock);</div><div class="line">        cc-&gt;counter = 0;</div><div class="line">  </div><div class="line">        PARCClock *clock = <a class="code" href="parc___memory_8h.html#a8c38f4179c6a9f03bb69c148c4990717">parcMemory_Allocate</a>(<span class="keyword">sizeof</span>(PARCClock));</div><div class="line">        clock-&gt;closure = cc;</div><div class="line">        clock-&gt;acquire = _counterClock_AcquireInterface;</div><div class="line">        clock-&gt;release = _counterClock_ReleaseInterface;</div><div class="line">        clock-&gt;getTime = _counterClock_GetTime;</div><div class="line">        clock-&gt;getTimeval = _counterClock_GetTimeval;</div><div class="line">        <span class="keywordflow">return</span> clock;</div><div class="line">     }</div><div class="line">   @encode</div><div class="line">  </div><div class="line">   @author Marc Mosko, Palo Alto Research Center (Xerox PARC)</div><div class="line">   @copyright (c) 2015, Xerox Corporation (Xerox) and Palo Alto Research Center, Inc (PARC).  All rights reserved.</div><div class="line">  /</div><div class="line"></div><div class="line"><span class="preprocessor">#ifndef PARC_parc_Clock_h</span></div><div class="line"><span class="preprocessor">#define PARC_parc_Clock_h</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;inttypes.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;sys/time.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">struct </span>parc_clock;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>parc_clock PARCClock;</div><div class="line"></div><div class="line"><span class="keyword">struct </span>parc_clock {</div><div class="line">    <span class="keywordtype">void</span> *closure;</div><div class="line"></div></div><!-- fragment --> </div>
<p><a href="parc___clock_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2db007eb03ec32551e117113bd6c4339"><td class="memItemLeft" align="right" valign="top">PARCClock *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parc___clock_8h.html#a2db007eb03ec32551e117113bd6c4339">parcClock_Wallclock</a> (void)</td></tr>
<tr class="memdesc:a2db007eb03ec32551e117113bd6c4339"><td class="mdescLeft">&#160;</td><td class="mdescRight">A clock provider for the wall clock time.  <a href="#a2db007eb03ec32551e117113bd6c4339">More...</a><br /></td></tr>
<tr class="separator:a2db007eb03ec32551e117113bd6c4339"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b0ecb2fc31b116ec702c00304a48e91"><td class="memItemLeft" align="right" valign="top">PARCClock *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parc___clock_8h.html#a7b0ecb2fc31b116ec702c00304a48e91">parcClock_Monotonic</a> (void)</td></tr>
<tr class="memdesc:a7b0ecb2fc31b116ec702c00304a48e91"><td class="mdescLeft">&#160;</td><td class="mdescRight">A monotonic clock that will not normally adjust for time changes.  <a href="#a7b0ecb2fc31b116ec702c00304a48e91">More...</a><br /></td></tr>
<tr class="separator:a7b0ecb2fc31b116ec702c00304a48e91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae76be349864034663f1c734bda79ecb1"><td class="memItemLeft" align="right" valign="top">PARCClock *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parc___clock_8h.html#ae76be349864034663f1c734bda79ecb1">parcClock_Counter</a> (void)</td></tr>
<tr class="memdesc:ae76be349864034663f1c734bda79ecb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The counter clock begins at 0 and increments for every call to getTime or getTimeval.  <a href="#ae76be349864034663f1c734bda79ecb1">More...</a><br /></td></tr>
<tr class="separator:ae76be349864034663f1c734bda79ecb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a010c73e784ff5d52d1f6bb341090f3ce"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parc___clock_8h.html#a010c73e784ff5d52d1f6bb341090f3ce">parcClock_GetTime</a> (const PARCClock *clock)</td></tr>
<tr class="memdesc:a010c73e784ff5d52d1f6bb341090f3ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the clock provider's idea of the current time as a uint64.  <a href="#a010c73e784ff5d52d1f6bb341090f3ce">More...</a><br /></td></tr>
<tr class="separator:a010c73e784ff5d52d1f6bb341090f3ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab65ab642cda97451d165a1cdb287a751"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parc___clock_8h.html#ab65ab642cda97451d165a1cdb287a751">parcClock_GetTimeval</a> (const PARCClock *clock, struct timeval *output)</td></tr>
<tr class="memdesc:ab65ab642cda97451d165a1cdb287a751"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the clock provider's idea of the current time as a timeval.  <a href="#ab65ab642cda97451d165a1cdb287a751">More...</a><br /></td></tr>
<tr class="separator:ab65ab642cda97451d165a1cdb287a751"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ca70a15277117a98add7a08938134a4"><td class="memItemLeft" align="right" valign="top">PARCClock *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parc___clock_8h.html#a0ca70a15277117a98add7a08938134a4">parcClock_Acquire</a> (const PARCClock *clock)</td></tr>
<tr class="memdesc:a0ca70a15277117a98add7a08938134a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increase the number of references to a <code>PARCClock</code>.  <a href="#a0ca70a15277117a98add7a08938134a4">More...</a><br /></td></tr>
<tr class="separator:a0ca70a15277117a98add7a08938134a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0220e7139789ef8210b3d870dde0ff6b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parc___clock_8h.html#a0220e7139789ef8210b3d870dde0ff6b">parcClock_Release</a> (PARCClock **clockPtr)</td></tr>
<tr class="memdesc:a0220e7139789ef8210b3d870dde0ff6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release a previously acquired reference to the specified instance, decrementing the reference count for the instance.  <a href="#a0220e7139789ef8210b3d870dde0ff6b">More...</a><br /></td></tr>
<tr class="separator:a0220e7139789ef8210b3d870dde0ff6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6ac779e5e07b8cb6ca3e0378b555a9a8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6ac779e5e07b8cb6ca3e0378b555a9a8"></a>
uint64_t(*&#160;</td><td class="memItemRight" valign="bottom"><b>getTime</b> )(const PARCClock *clock)</td></tr>
<tr class="separator:a6ac779e5e07b8cb6ca3e0378b555a9a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64ba1fbb95457320302cf3855b01073e"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parc___clock_8h.html#a64ba1fbb95457320302cf3855b01073e">getTimeval</a> )(const PARCClock *clock, struct timeval *output)</td></tr>
<tr class="memdesc:a64ba1fbb95457320302cf3855b01073e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the clock time as a struct timeval.  <a href="#a64ba1fbb95457320302cf3855b01073e">More...</a><br /></td></tr>
<tr class="separator:a64ba1fbb95457320302cf3855b01073e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6144174782080d84a26a0a7d5cc45f73"><td class="memItemLeft" align="right" valign="top">PARCClock *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parc___clock_8h.html#a6144174782080d84a26a0a7d5cc45f73">acquire</a> )(const PARCClock *clock)</td></tr>
<tr class="memdesc:a6144174782080d84a26a0a7d5cc45f73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increase the number of references to a <code>PARCClock</code>.  <a href="#a6144174782080d84a26a0a7d5cc45f73">More...</a><br /></td></tr>
<tr class="separator:a6144174782080d84a26a0a7d5cc45f73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a032690cc2a990c5be7b36e7b3e3c2880"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parc___clock_8h.html#a032690cc2a990c5be7b36e7b3e3c2880">release</a> )(PARCClock **clockPtr)</td></tr>
<tr class="memdesc:a032690cc2a990c5be7b36e7b3e3c2880"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release a previously acquired reference to the specified instance, decrementing the reference count for the instance.  <a href="#a032690cc2a990c5be7b36e7b3e3c2880">More...</a><br /></td></tr>
<tr class="separator:a032690cc2a990c5be7b36e7b3e3c2880"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a0ca70a15277117a98add7a08938134a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PARCClock* parcClock_Acquire </td>
          <td>(</td>
          <td class="paramtype">const PARCClock *&#160;</td>
          <td class="paramname"><em>clock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Increase the number of references to a <code>PARCClock</code>. </p>
<p>Note that new <code>PARCClock</code> is not created, only that the given <code>PARCClock</code> reference count is incremented. Discard the reference by invoking <code>parcClock_Release</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">clock</td><td>A pointer to a <code>PARCClock</code> instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The input <code>PARCClock</code> pointer.</dd></dl>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    PARCClock *clock = parcClock_Counter();</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    PARCClock *copy = parcClock_Acquire(clock);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    parcClock_Release(&amp;copy);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    parcClock_Release(&amp;clock);</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;}</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ae76be349864034663f1c734bda79ecb1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PARCClock* parcClock_Counter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The counter clock begins at 0 and increments for every call to getTime or getTimeval. </p>
<p>Each allocated counter clock will begin at zero. Copies made via <a class="el" href="parc___clock_8h.html#a0ca70a15277117a98add7a08938134a4" title="Increase the number of references to a PARCClock. ">parcClock_Acquire()</a> will share the same counter and use atomic updates.</p>
<p>getTime() will return the counter.</p>
<p><a class="el" href="parc___clock_8h.html#a64ba1fbb95457320302cf3855b01073e" title="Gets the clock time as a struct timeval. ">getTimeval()</a> will return the lower 19 bits in tv_usec (so it does not overflow the concept of micro-second) and the upper 45 bits are in tv_sec. On some platforms, that may overflow.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-null</td><td>An allocated PARCClock, which must be released via parcClock_Release.</td></tr>
  </table>
  </dd>
</dl>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    PARCClock *clock = parcClock_Counter();</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    uint64_t t = parcClock_GetTime(clock);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    parcClock_Release(&amp;clock);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;}</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a010c73e784ff5d52d1f6bb341090f3ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t parcClock_GetTime </td>
          <td>(</td>
          <td class="paramtype">const PARCClock *&#160;</td>
          <td class="paramname"><em>clock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the clock provider's idea of the current time as a uint64. </p>
<p>Returns the clock provider's idea of the current time, which may or may not be a wall clock time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">clock</td><td>A clock provider</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">number</td><td>The current time (depends on provider)</td></tr>
  </table>
  </dd>
</dl>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    PARCClock *clock = parcClock_Counter();</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    uint64_t t = parcClock_GetTime(clock);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    parcClock_Release(&amp;clock);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;}</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ab65ab642cda97451d165a1cdb287a751"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parcClock_GetTimeval </td>
          <td>(</td>
          <td class="paramtype">const PARCClock *&#160;</td>
          <td class="paramname"><em>clock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the clock provider's idea of the current time as a timeval. </p>
<p>Returns the clock provider's idea of the current time, which may or may not be a wall clock time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">clock</td><td>A clock provider </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">output</td><td>The structure to fill in with the current time</td></tr>
  </table>
  </dd>
</dl>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    struct timeval t;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    PARCClock *clock = parcClock_Counter();</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    parcClock_GetTimeval(clock, &amp;t);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    parcClock_Release(&amp;clock);</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;}</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a7b0ecb2fc31b116ec702c00304a48e91"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PARCClock* parcClock_Monotonic </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A monotonic clock that will not normally adjust for time changes. </p>
<p>On linux, this uses the CLOCK_MONOTONIC_RAW. On Darwin, it uses the SYSTEM_CLOCK from &lt;mach/mach_time.h&gt;.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-null</td><td>An allocated PARCClock, which must be released via parcClock_Release.</td></tr>
  </table>
  </dd>
</dl>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    PARCClock *clock = parcClock_Monotonic();</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    uint64_t t = parcClock_GetTime(clock);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    parcClock_Release(&amp;clock);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;}</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a0220e7139789ef8210b3d870dde0ff6b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parcClock_Release </td>
          <td>(</td>
          <td class="paramtype">PARCClock **&#160;</td>
          <td class="paramname"><em>clockPtr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Release a previously acquired reference to the specified instance, decrementing the reference count for the instance. </p>
<p>The pointer to the instance is set to NULL as a side-effect of this function.</p>
<p>If the invocation causes the last reference to the instance to be released, the instance is deallocated and the instance's implementation will perform additional cleanup and release other privately held references.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">clockPtr</td><td>A pointer to a pointer to the instance to release.</td></tr>
  </table>
  </dd>
</dl>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    PARCClock *clock = parcClock_Counter();</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    PARCClock *copy = parcClock_Acquire(clock);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    parcClock_Release(&amp;copy);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    parcClock_Release(&amp;clock);</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;}</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a2db007eb03ec32551e117113bd6c4339"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PARCClock* parcClock_Wallclock </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A clock provider for the wall clock time. </p>
<p>This will use clock_gettime(CLOCK_REALTIME_COARSE) on linux or host_get_clock_service with CALENDAR_CLOCK on Mac</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-null</td><td>An allocated PARCClock, which must be released via parcClock_Release.</td></tr>
  </table>
  </dd>
</dl>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    PARCClock *clock = parcClock_Wallclock();</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    uint64_t t = parcClock_GetTime(clock);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    parcClock_Release(&amp;clock);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;}</div></div><!-- fragment --> 
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a6144174782080d84a26a0a7d5cc45f73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PARCClock*(* acquire) (const PARCClock *clock)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Increase the number of references to a <code>PARCClock</code>. </p>
<p>Note that new <code>PARCClock</code> is not created, only that the given <code>PARCClock</code> reference count is incremented. Discard the reference by invoking <code>parcClock_Release</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">clock</td><td>A pointer to a <code>PARCClock</code> instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The input <code>PARCClock</code> pointer.</dd></dl>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    PARCClock *clock = parcClock_Counter();</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    PARCClock *copy = parcClock_Acquire(clock);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    parcClock_Release(&amp;copy);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    parcClock_Release(&amp;clock);</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;}</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a64ba1fbb95457320302cf3855b01073e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* getTimeval) (const PARCClock *clock, struct timeval *output)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the clock time as a struct timeval. </p>
<p>The resolution and epoch of the clock are determined by the clock provider. There may be an arbitrary mapping to the struct timeval as per the clock provider, so the units of 'seconds' and 'micro seconds' need to be interpreted as per the clock provider.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">clock</td><td>An allocated PARCClock</td></tr>
  </table>
  </dd>
</dl>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;#example#&gt;</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a032690cc2a990c5be7b36e7b3e3c2880"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* release) (PARCClock **clockPtr)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Release a previously acquired reference to the specified instance, decrementing the reference count for the instance. </p>
<p>The pointer to the instance is set to NULL as a side-effect of this function.</p>
<p>If the invocation causes the last reference to the instance to be released, the instance is deallocated and the instance's implementation will perform additional cleanup and release other privately held references.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">clockPtr</td><td>A pointer to a pointer to the instance to release.</td></tr>
  </table>
  </dd>
</dl>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    PARCClock *clock = parcClock_Counter();</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    PARCClock *copy = parcClock_Acquire(clock);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    parcClock_Release(&amp;copy);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    parcClock_Release(&amp;clock);</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;}</div></div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
<!--END GENERATE_TREEVIEW-->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/>
  <div class="container footer">
Copyright © 2008-2016, Xerox Corporation (Xerox) and Palo Alto Research Center, Inc (PARC)<br/>
Thu Aug 25 2016 12:43:59
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
//<![CDATA[
var sc_project=11084416; 
var sc_invisible=0;
var sc_security="641a5c50"; 
var scJsHost = (("https:" == document.location.protocol) ?  "https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" + scJsHost+ "statcounter.com/counter/counter_xhtml.js'></"+"script>");
//]]>
</script>
<noscript>
<div class="statcounter">
<a title="shopify site analytics" href="http://statcounter.com/shopify/" class="statcounter">
<img class="statcounter" style="width: 2;" src="//c.statcounter.com/11084416/0/641a5c50/0/" alt="statcounter" />
</a></div></noscript>
  </div>
<!-- End of StatCounter Code for Default Guide -->
  </div>
</body>
</html>
